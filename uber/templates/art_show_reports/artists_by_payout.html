{% extends 'static_views/static_base.html' %}
{% import 'art_show_common/print_macros.html' as print_macros with context %}

{% set no_print = True %}
{% include 'art_show_common/print.html' with context %}
{% import 'macros.html' as macros with context %}

{% block page %}
<h3 align="center">Artist Payout Report -- {{ now_localized()|datetime("%m/%d/%Y, %-I:%M%p") }}</h3>
<div class="d-print-none card-body">
<strong>{{ message }}</strong>
<form role="form" method="get" action="artists_by_payout">
  <div class="row g-3 mb-3">
    <div class="col-sm">
      <div class="form-text">Include Payout Methods</div>
      {{ macros.checkgroup_opts('yes_methods', c.ARTIST_PAYOUT_METHOD_OPTS, defaults=[] if not yes_methods else yes_methods|join(',')) }}
    </div>
    <div class="col-sm">
      <div class="form-text">Exclude Payout Methods</div>
      {{ macros.checkgroup_opts('no_methods', c.ARTIST_PAYOUT_METHOD_OPTS, defaults=[] if not no_methods else no_methods|join(',')) }}
    </div>
  </div>
  <div class="d-flex gap-2">
    <div>
      <button type="submit" class="btn btn-primary">Load Artists by Payout Method</button>
    </div>
    <div><a href="javascript:window.print()" class="btn btn-success">Print Artists</a></div>
  </div>
</form>
</div>

<div class="card-body p-0 m-0">
    <table class="table table-bordered" style="margin: 20px; width: calc(100% - 40px);">
        {% for method, label in c.ARTIST_PAYOUT_METHOD_OPTS %}
        <tr>
            <td><strong>{{ label }} $ Sold</strong></td><td>{{ totals_by_method[method] }}</td>
        </tr>
        {% endfor %}
    </table>
</div>

<div class="card-body p-0 m-0">
{% for app in apps %}
<table class="table table-bordered" style="margin: 20px; width: calc(100% - 40px);">
  <tr>
    <td><strong>Artist ID</strong></td><td colspan="2">{{ app.artist_id }}{% if app.artist_id_ad %} ({{ app.artist_id_ad }}){% endif %}</td>
  </tr>
  <tr>
    <td><strong>Artist Name</strong></td><td colspan="2">{{ app.display_name }}{% if app.banner_name_ad %} ({{ app.mature_display_name }}){% endif %}</td>
  </tr>
  <tr>
    <td><strong>Payout Method</strong></td><td colspan="2">{{ app.payout_method_label }}</td>
  </tr>
  <tr>
    <th>$ Won Bids</th>
    <th>Total $ Sold/Paid</th>
    <th>#/$ Available for QS</th>
  </tr>
  <tr>
    <td>{{ won_bids[app.id] }}</td>
    <td>{{ total_money[app.id] }}</td>
    <td>{{ qs_num[app.id] }}/{{ qs_total[app.id] }}</td>
  </tr>
</table>
{% endfor %}
</div>
{% endblock %}