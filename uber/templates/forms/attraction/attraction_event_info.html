{% import 'macros.html' as macros with context %}
{% import 'forms/macros.html' as form_macros with context %}
{% set attraction_event_info = attraction_event_info or forms['attraction_event_info'] %}

{# BLOCK NAMES in this form:
    x_data
    location_category
    name_description
    time_duration

  Use these to add or rearrange fields. Remember to use {{ super() }} to print the original fields as-is.
#}

{% set used_location_opts = attraction.used_location_opts %}
{% set event_location_opts = (used_location_opts + [('', '––––––––––')] + attraction.unused_location_opts) if used_location_opts else attraction.unused_location_opts %}

<div x-data="{ {% block x_data %}
signups_open_type: '{{ attraction_event_info.signups_open_type.data }}',
waitlist_available: {{ attraction_event_info.waitlist_available.data|boolean|tojson }},
{% endblock %} }">

<div class="row g-3 mb-3">
{% block location_name_desc %}
<div class="col-sm"><div class="form-text">Feature</div>{{ feature.name }}</div>
<div class="col-sm">
    {{ form_macros.input(attraction_event_info.event_location_id, choices=event_location_opts) }}
</div>
{% endblock %}
</div>

<div class="row g-3 mb-3">
{% block slots_time_duration %}
<div class="col-sm">{{ form_macros.input(attraction_event_info.slots) }}</div>
<div class="col-sm">{{ form_macros.input(attraction_event_info.start_time) }}</div>
<div class="col-sm">{{ form_macros.input(attraction_event_info.duration) }}</div>
{% endblock %}
</div>

<div class="card card-body bg-light mb-3">
    <span class="form-text mb-3">
        Synced Settings <a href="#" data-bs-toggle="tooltip" title="These settings are controlled by the {{ feature.name }} feature and {{ attraction.name }} attraction but may be overridden here."><i class="fa fa-question-circle" aria-hidden="true"></i> What's this?</a>
    </span>
<div class="row g-3 mb-3">
{% block defaults %}
    <div class="col-sm">{{ form_macros.input(attraction_event_info.populate_schedule) }}</div>
    <div class="col-sm">{{ form_macros.input(attraction_event_info.no_notifications) }}</div>
</div><div class="row g-3 mb-3">
    <div class="col-sm">
        {{ form_macros.input(attraction_event_info.waitlist_available, alpine_model="waitlist_available") }}
        <div x-show="waitlist_available">{{ form_macros.input(attraction_event_info.waitlist_slots, required_if="waitlist_available") }}</div>
    </div>
    <div class="col-sm">
        {% call form_macros.input(attraction_event_info.signups_open_type, alpine_model="signups_open_type") %}
        <div x-show="signups_open_type == 'relative'">
            {{ form_macros.input(attraction_event_info.signups_open_relative, required_if="signups_open_type == 'relative'") }}
        </div>
        <div x-show="signups_open_type == 'absolute'">
            {{ form_macros.input(attraction_event_info.signups_open_time, min_date=attraction.minimum_signups_open, required_if="signups_open_type == 'absolute'") }}
        </div>
        {% endcall %}
    </div>
{% endblock %}
</div>
</div>

</div>