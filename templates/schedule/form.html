{% extends "base.html" %}
{% block title %}Schedule{% endblock %}
{% block content %}

<script type="text/javascript">
    var panelists = {{ panelists|jsonize }};
    
    var $panelists = $("<select/>").attr("name", "panelists").css("margin-right", "10px");
    $.each(panelists, function(i,p) {
        $panelists.append( $("<option/>").attr("value", p[0]).text(p[1]) );
    });
    
    var removePanelist = function(event) {
        event.preventDefault();
        $(event.target).parent("div").remove();
    };
    var addPanelist = function(id) {
        $("#add").after(
            $("<div/>").css("padding-top", "5px")
                       .append(
                            $panelists.clone()
                                      .val(id || $panelists.val()))
                       .append(
                            $("<a/>").attr("href", "#")
                                     .text("Remove Panelist")
                                     .click(removePanelist)));
    };
    
    $(function(){
        $.each({{ assigned|jsonize }}, function(i,id) {
            addPanelist(id);
        });
    });
</script>

<form method="post" action="form">
<input type="hidden" name="id" value="{{ event.id }}" />

<table width="100%" cellspacing="5" cellpadding="5">
<tr>
    <td width="25%"><b>Location:</b></td>
    <td width="75%">
        <select name="location">
            {% options EVENT_LOC_OPTS event.location %}
        </select>
    </td>
</tr>
<tr>
    <td><b>Time:</b></td>
    <td>
        <select name="start_time">
            {% options EVENT_START_TIME_OPTS event.start_time %}
        </select>
    </td>
</tr>
<tr>
    <td><b>Duration:</b></td>
    <td>
        <select name="duration">
            {% options EVENT_DURATION_OPTS event.duration %}
        </select>
    </td>
</tr>
<tr>
    <td><b>Event Name:</b></td>
    <td> <input class="focus" type="text" name="name" value="{{ event.name }}" /> </td>
</tr>
<tr>
    <td valign="top">Panelists</td>
    <td>
        <a id="add" href="#" onClick="addPanelist(); return false">Add a Panelist</a>
    </td>
</tr>
<tr>
    <td valign="top">Description:</td>
    <td> <textarea rows="6" cols="40" name="description">{{ event.description }}</textarea> </td>
</tr>
</table>

<div style="width:75% ; margin-left:25%">
    <input type="submit" value="Upload Event Data" />
</div>

</form>

{% if event.id %}
    <br/>
    <div style="width:75% ; margin-left:25%">
        <form method="post" action="delete" onSubmit="return confirm('Are you sure you want to delete this event?');">
            <input type="hidden" name="id" value="{{ event.id }}" />
            <input type="submit" value="Delete This Event" />
        </form>
    </div>
{% endif %}

{% add_max_lengths Event %}

{% endblock %}
